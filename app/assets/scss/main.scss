@use 'sass:math';
@use 'sass:map';

/*=======================================================
                REGISTER-TAILWIND
=========================================================*/
@tailwind base;
@tailwind components;
@tailwind utilities;

/*=======================================================
              ðŸŽ¨ Custom Application Fonts
=========================================================*/
$family: 'Noto Serif Bengali', serif, Helvetica, Arial, sans-serif;
$font-path: '../fonts/NotoSerifBengali';
$font-weights: (
  normal: 400,
  medium: 500,
  semibold: 600,
  bold: 700,
);

@mixin font-face($family, $weight, $style: normal) {
  $file: 'NotoSerifBengali-';

  @if $weight == 400 {
    $file: $file + 'Regular';
  } @else if $weight == 500 {
    $file: $file + 'Medium';
  } @else if $weight == 600 {
    $file: $file + 'SemiBold';
  } @else if $weight == 700 {
    $file: $file + 'Bold';
  } @else {
    $file: $file + 'Regular';
  }

  @font-face {
    font-family: $family;
    src:
      url('#{$font-path}/#{$file}.woff2') format('woff2'),
      url('#{$font-path}/#{$file}.woff') format('woff');
    font-display: swap;
    font-style: $style;
    font-weight: $weight;
  }
}

@mixin customfont($family, $weight) {
  $numeric-weight: if(
    map.has-key($font-weights, $weight),
    map.get($font-weights, $weight),
    $weight
  );

  @include font-face($family, $numeric-weight);
}

/* LOAD FONTS */
@include customfont($family, normal);
@include customfont($family, medium);
@include customfont($family, semibold);
@include customfont($family, bold);

/*=======================================================
                        BASE LAYER
   (Put global @apply here so Tailwind can expand it)
=========================================================*/
@layer base {
  ::selection {
    @apply bg-primary text-light;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-light text-dark dark:bg-dark-surface dark:text-white font-bengali text-sizeDefault font-normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  img {
    @apply cursor-pointer max-w-full h-auto;
  }

  a,
  button {
    @apply cursor-pointer;
  }

  /* BRAND-LOGO */
  .logo {
    @apply w-full h-full flex items-center justify-center overflow-hidden; //sm:h-7 md:h-7.5 lg:h-8

    img {
      @apply w-full h-full object-cover md:object-contain;
    }
  }

  /* ROUTER-LINKS-ACTIVE */
  .router-link-active,
  .router-link-exact-active {
    &:hover {
      @apply border-white dark:border-gray-300;
    }
  }

  /* HEADER */
  .header-link {
    @apply border-b-4 border-transparent text-dark-surface dark:text-white font-bengali text-sizeMedium font-normal md:text-sizeBig;

    &:hover {
      &:not(.router-link-active),
      &:not(.router-link-exact-active) {
        @apply border-b-primary;
      }
    }

    &.router-link-active,
    &.router-link-exact-active {
      @apply border-b-primary;
    }
  }

  .router-link-active,
  .router-link-exact-active {
    &:not(.router-link-exact-active.mobile-link) {
      @apply border-b-primary;
    }
  }
}

/*=======================================================
                      UTILITIES LAYER
=========================================================*/
@layer utilities {
  /* APP-PAGE-TRANSITIONS */
  .page-enter-active,
  .page-leave-active {
    @apply transition-all duration-400;
  }

  .page-enter-from,
  .page-leave-to {
    @apply opacity-0 blur-4;
  }

  /* APP-CONTAINER */
  .jonopath-container {
    @apply max-w-63 w-full h-full mx-auto px-2 ss:px-4;
  }

  .redirect {
    @apply relative after:inline-block after:w-4 after:text-left after:animate-ellipsis;
  }

  .scrollbar-none::-webkit-scrollbar,
  .scrollbar-none {
    scrollbar-width: none;
  }

  /* MAX-WIDTH */
  .scrollable-nav {
    @apply max-md:whitespace-nowrap max-md:overflow-x-scroll max-md:scroll-auto max-md:scrollbar-none max-md:max-w-[calc(100%-theme(spacing.3))];
  }

  /* SLIDE-LEAVE-ANIMATION(OFFCANVAS) */
  .slide-enter-from {
    transform: translateX(-100%);
  }

  .slide-enter-to {
    transform: translateX(0);
  }

  .slide-leave-from {
    transform: translateX(0);
  }

  .slide-leave-to {
    transform: translateX(-100%);
  }

  .slide-enter-active,
  .slide-leave-active {
    transition: transform 0.3s ease;
  }

  /* Animation helpers as utilities */
  .animate-slide-up {
    animation: slideUp 0.4s ease-out forwards;
  }
  .animate-slide-up-fade {
    animation: slideUpFade 0.3s forwards;
  }
  .animate-slide-down {
    animation: slideDownFade 0.3s forwards;
  }
  .animate-slide-up-bottom {
    animation: slideUpFadeBottom 0.3s forwards;
  }
  .animate-slide-down-bottom {
    animation: slideDownFadeBottom 0.3s forwards;
  }

  /* HAMBURGER-MENU-ANIMATION */
  /* Slide Down Animation */
  .collapse-enter-from,
  .collapse-leave-to {
    @apply max-h-0;
  }

  .collapse-enter-to,
  .collapse-leave-from {
    @apply max-h-36.5;
  }

  .collapse-enter-active,
  .collapse-leave-active {
    // transition: max-height 0.3s ease;
    @apply overflow-hidden transition-max-height duration-300 ease-max;
  }
}

/*=======================================================
                    COMPONENTS LAYER
=========================================================*/
@layer components {
  /* TOPBAR */
  .topbar {
    @apply bg-primary flex items-center w-full h-11 xs:h-15 sm:h-16;

    &-link {
      @apply w-40 h-full border-b-4 border-transparent hover:border-b-white dark:hover:border-gray-300 flex items-center justify-center px-0.125;

      &.router-link-active,
      &.router-link-exact-active {
        &:hover {
          &:not(.router-link-exact-active.mobile-link) {
            @apply border-white dark:border-gray-300;
          }
        }
      }
    }
  }

  /* MOBILE LINK (kept nested, combined duplicates) */
  .mobile-link {
    @apply text-dark-surface dark:text-white align-middle;

    &-text {
      @apply inline-flex pl-1 border-l-4 border-transparent align-middle font-bengali text-sizeMedium font-normal;
    }

    &:hover {
      &:not(.router-link-active),
      &:not(.router-link-exact-active) {
        .mobile-link-text {
          @apply border-l-primary;
        }
      }
    }

    &.router-link-active,
    &.router-link-exact-active {
      .mobile-link-text {
        @apply border-l-primary;
      }
    }
  }

  .hamburger {
    @apply overflow-x-hidden overflow-y-auto whitespace-nowrap scroll-auto scrollbar-none;
  }

  .offcanvas {
    @apply h-screen overflow-x-hidden overflow-y-auto whitespace-nowrap scroll-auto scrollbar-none;
  }

  .footer-list {
    @apply grid gap-x-2 [grid-template-rows:repeat(4,auto)] [grid-template-columns:repeat(2,1fr)] [column-count:2] pb-2 md:gap-x-4 md:[grid-template-rows:repeat(3,auto)] md:[grid-template-columns:repeat(3,1fr)] md:[column-count:3] lg:[grid-template-columns:repeat(4,1fr)] lg:[column-count:4];

    &-item {
      @apply py-2;

      &:first-of-type {
        @apply col-span-full border-b border-dark-divider w-full mb-2;
      }
    }

    &-link {
      @apply text-sm ss:text-sizeSmall font-bold py-3 md:text-sizeDefault transition-all hover:underline;
    }
  }

  .main-news-list {
    @apply grid grid-cols-2 gap-4 mb-10 md:grid-cols-3 lg:grid-cols-4;

    &-item {
      @apply pt-2;

      .main-news-article {
        h2 {
          @apply text-dark-surface hover:text-dark-hover dark:text-light dark:hover:text-white text-sizeBig font-bold sm:mb-2 md:text-sizeLg max-xs:line-clamp-2;
        }

        p {
          @apply hidden;
        }

        time {
          @apply text-xs text-dark-hover dark:text-light inline-block;
        }
      }

      &:first-child {
        @apply row-span-3 col-span-2 md:row-span-2 border-0;

        .main-news-article {
          h2 {
            @apply text-sizeXl md:text-sizeXXl;
          }

          p {
            @apply md:block mb-2;
          }
        }
      }

      &:nth-child(2),
      &:nth-child(3),
      &:nth-child(4),
      &:nth-child(5),
      &:nth-child(6),
      &:nth-child(7) {
        @apply row-span-1 col-span-2 ss:row-span-2 ss:col-span-1 border-t border-light-50 dark:border-dark-divider ss:border-0;

        .main-news-article {
          @apply max-xs:flex;

          .main-news-thumbnail {
            @apply max-xs:w-1/3;
          }

          .main-news-details {
            @apply max-xs:w-2/3 max-xs:pl-2;
          }
        }
      }

      &:nth-child(2),
      &:nth-child(3) {
        @apply md:row-span-1 md:col-span-1;
      }

      &:nth-child(4),
      &:nth-child(5),
      &:nth-child(6) {
        @apply md:row-span-1 md:col-span-1;
      }

      &:nth-child(8),
      &:nth-child(9) {
        @apply row-span-1 col-span-2 border-t border-light-50 dark:border-dark-divider;

        .main-news-article {
          @apply flex;

          .main-news-thumbnail {
            @apply w-1/3;
          }

          .main-news-details {
            @apply w-2/3 pl-2;
          }
        }
      }

      &:nth-child(7),
      &:nth-child(8),
      &:nth-child(9) {
        @apply md:row-span-1 md:col-span-1;

        .main-news-article {
          @apply md:flex;

          .main-news-thumbnail {
            @apply md:hidden;
          }

          .main-news-details {
            @apply md:w-full md:pl-0;
          }
        }
      }

      &:nth-child(7) {
        @apply md:border-t md:border-light-50 md:dark:border-dark-divider;
      }

      &:nth-child(6) {
        @apply lg:border-t lg:border-light-50 lg:dark:border-dark-divider lg:row-span-1 lg:col-span-1;

        .main-news-article {
          .main-news-thumbnail {
            @apply lg:hidden;
          }

          .main-news-details {
            @apply lg:w-full lg:pl-0;
          }
        }
      }
    }

    .main-news-link {
      &:hover,
      &:visited {
        .main-news-article {
          h2 {
            @apply text-dark-hover dark:text-white underline;
          }
        }
      }
    }
  }

  .selected-news-list {
    @apply grid grid-cols-2 gap-4 mb-5 md:mb-10 md:grid-cols-3 lg:grid-cols-4;

    &-item {
      @apply pt-2;

      .selected-news-article {
        .selected-news-details {
          h2 {
            @apply text-dark-surface hover:text-dark-hover dark:text-light dark:hover:text-white text-sizeBig font-bold sm:mb-2 md:text-sizeLg leading-6 max-xs:line-clamp-2;
          }

          p {
            @apply hidden;
          }

          time {
            @apply text-xs text-dark-hover dark:text-light inline-block;
          }
        }
      }

      &:first-child {
        @apply row-span-3 col-span-2 md:row-span-2 border-0;

        .selected-news-article {
          .selected-news-details {
            h2 {
              @apply text-sizeXl md:text-sizeXXl leading-8;
            }

            p {
              @apply md:block mb-2 leading-8;
            }
          }
        }
      }

      &:nth-child(2),
      &:nth-child(3),
      &:nth-child(4),
      &:nth-child(5) {
        @apply row-span-1 col-span-2 ss:row-span-2 ss:col-span-1 border-t border-light-50 dark:border-dark-divider ss:border-0;

        .selected-news-article {
          @apply max-xs:flex;

          .selected-news-thumbnail {
            @apply max-xs:w-1/3;
          }

          .selected-news-details {
            @apply max-xs:w-2/3 max-xs:pl-2;
          }
        }
      }

      &:nth-child(2),
      &:nth-child(3) {
        @apply md:row-span-1 md:col-span-1;
      }

      &:nth-child(4),
      &:nth-child(5) {
        @apply md:row-span-1 md:col-span-1;
      }
    }

    .selected-news-link {
      &:hover,
      &:visited {
        .selected-news-article {
          h2 {
            @apply text-dark-hover dark:text-white underline;
          }
        }
      }
    }
  }

  .others-news-list {
    @apply grid ss:grid-cols-2 gap-4 mb-10 md:grid-cols-3 lg:grid-cols-4;

    &-item {
      @apply max-sm:row-span-1 max-sm:col-span-2 pt-2;

      .others-news-article {
        @apply max-sm:flex;

        .others-news-thumbnail {
          @apply max-sm:w-1/3;
        }

        .others-news-details {
          @apply max-sm:w-2/3 max-sm:pl-2;

          h2 {
            @apply text-dark-surface hover:text-dark-hover dark:text-light dark:hover:text-white text-sizeBig font-bold sm:mb-2 md:text-sizeLg leading-6 max-xs:line-clamp-2;
          }

          time {
            @apply text-xs text-dark-hover dark:text-light inline-block;
          }
        }
      }
    }

    .others-news-link {
      &:hover,
      &:visited {
        .others-news-article {
          h2 {
            @apply text-dark-hover dark:text-white underline;
          }
        }
      }
    }
  }

  .popular-news-list {
    @apply grid gap-4 grid-flow-col grid-rows-5 md:grid-rows-3 md:grid-cols-2;

    &-link {
      @apply flex items-center gap-4;

      .news-counter,
      .news-title {
        @apply inline-block;
      }

      .news-counter {
        @apply text-primary font-bengali text-size3XXl md:text-5xl lg:text-sizeXXXl;
      }

      .news-title {
        @apply text-dark-surface dark:text-white font-bengali font-bold text-sizeMedium md:text-sizeXl lg:text-size1Xl transition-all;
      }

      &:hover {
        .news-title {
          @apply underline;
        }
      }
    }
  }
}

/*=======================================================
                  FEATURE QUERIES / SUPPORT
=========================================================*/

/* âœ… Put @supports */
@supports (grid-template-columns: fit-content(var(--footer-col))) {
  .footer-list {
    @apply grid auto-cols-[fit-content(var(--footer-col))] grid-flow-col;
  }
}

/*=======================================================
                  KEYFRAMES
=========================================================*/
@keyframes slideUp {
  0% {
    transform: translateY(100%);
    opacity: 0;
  }
  100% {
    transform: translateY(0%);
    opacity: 1;
  }
}
@keyframes slideUpFade {
  0% {
    transform: translateY(0%);
    opacity: 1;
  }
  100% {
    transform: translateY(-100%);
    opacity: 0;
  }
}
@keyframes slideDownFade {
  0% {
    transform: translateY(-100%);
    opacity: 0;
  }
  100% {
    transform: translateY(0%);
    opacity: 1;
  }
}
@keyframes slideUpFadeBottom {
  0% {
    transform: translateY(100%);
    opacity: 0;
  }
  100% {
    transform: translateY(0%);
    opacity: 1;
  }
}
@keyframes slideDownFadeBottom {
  0% {
    transform: translateY(0%);
    opacity: 1;
  }
  100% {
    transform: translateY(100%);
    opacity: 0;
  }
}
